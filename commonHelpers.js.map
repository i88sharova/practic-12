{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["// https://unsplash.com/documentation#search-photos\nimport axios from 'axios';\nimport {Spinner} from 'spin.js';\nimport iziToast from \"izitoast\";\n// Додатковий імпорт стилів\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nconst opts = {\n    lines: 8, // The number of lines to draw\n    length: 38, // The length of each line\n    width: 17, // The line thickness\n    radius: 45, // The radius of the inner circle\n    scale: 1, // Scales overall size of the spinner\n    corners: 1, // Corner roundness (0..1)\n    speed: 1, // Rounds per second\n    rotate: 0, // The rotation offset\n    animation: 'spinner-line-fade-quick', // The CSS animation name for the lines\n    direction: 1, // 1: clockwise, -1: counterclockwise\n    color: '#287176', // CSS color or array of colors\n    fadeColor: 'transparent', // CSS color or array of colors\n    top: '50%', // Top position relative to parent\n    left: '50%', // Left position relative to parent\n    shadow: '0 0 1px transparent', // Box-shadow for the lines\n    zIndex: 2000000000, // The z-index (defaults to 2e9)\n    className: 'spinner', // The CSS class to assign to the spinner\n    position: 'absolute', // Element positioning\n  };\n//   константу opts пишем перед тем как ее будем передавать, т.к она не всплывает в любом месте\nconst target = document.querySelector(\".js-backdrop\")\n\n\n// const BASE_URL = 'https://api.unsplash.com';\n// const ENDPOINT = '/search/photos';\n// const API_KEY = 'LxvKVGJqiSe6NcEVZOaLXC-f2JIIWZaq_o0WrF8mwJc';\nconst formEl = document.querySelector(\".js-search-form\");\nconst listEl = document.querySelector(\".js-gallery\");\nlet page=1;\nlet query;\n\n\nconst options = {\n    root: null,\n    rootMargin: \"100px\",\n    threshold: 1.0,\n  };\n\n\nconst callback = function (entries, observer){\n    /* Content excerpted, show below */\n    entries.forEach (entry=> {\n        if(entry.isIntersecting) {\n            observer.unobserve(entry.target);\n            loadMoreData();\n        }\n    }\n\n    )\n  };\n  const spinner = new Spinner(opts);\n  const observer = new IntersectionObserver(callback, options);\n  \n\n\nformEl.addEventListener(\"submit\", onSubmit);\n\n\n\n\nasync function onSubmit(event){\n    event.preventDefault();\n    query = event.target.elements[\"user-search-query\"].value.trim();\n    spinnerPlay();\n\n    if(!query){\n        spinnerStop();\n        listEl.innerHTML='';\n        return iziToast.info({\n            position: 'topRight',\n            message: 'Error!!! - enter any symbol!'\n        });\n    }\n\n\n try { \n    const { data: {results, total, total_pages}} = await getPhotos(query, page);\n    // console.log(results, total);\n    if (total===0){\n        listEl.innerHTML='';\n        iziToast.info({\n            position: 'topRight',\n        message: `We found no one pictutes`,\n         })\n\n    } else {\n    listEl.innerHTML = createMarkup(results);\n    // alert(`We found ${total} pictutes`);\n    iziToast.success({\n        position: 'topRight',\n        message: `We found ${total} pictutes`,\n    });\n    hasMorePhotos(total_pages);\n}\n\n\n } catch (error) {\n    iziToast.error({\n        position: 'topRight',\n        message: 'Illegal operation',\n    });\n } \n \n finally { \n    spinnerStop();\n\n}\nevent.target.reset();\n}\nfunction createMarkup(arr=[]){\n     \n        return arr.map(photo => `<li class='gallery__item'>\n        <img src='${photo.urls.small}' alt='${photo.alt_description}' class='gallery-img' />\n        </li>`).join(\"\");\n    \n}\n\nfunction getPhotos(query, page){\n\naxios.defaults.baseURL = 'https://api.unsplash.com';\naxios.defaults.headers.common['Authorization'] = \"Client-ID LxvKVGJqiSe6NcEVZOaLXC-f2JIIWZaq_o0WrF8mwJc\";\n\n    return axios\n    .get(`/search/photos`, {\n        params: {\n        //   client_id: API_KEY,\n          query,\n          page,\n          query,\n          per_page: 12,\n          orientation: \"portrait\",\n        },\n      });\n}\n\nfunction spinnerPlay(){\n\n    spinner.spin(target);\n    target.classList.remove('is-hidden');\n}\n\nfunction spinnerStop(){\n    spinner.stop();\n    target.classList.add('is-hidden');\n}\n\nasync function loadMoreData() {\nconsole.log('LOAD');\npage+=1;\nspinnerPlay();\ntry {\n   const { data: { results, total_pages } } = await getPhotos(query, page);\n   listEl.insertAdjacentHTML('beforeend', createMarkup(results));\n   hasMorePhotos(total_pages);\n   \n   \n} catch (error) {\n\n    console.log(error);\n    \n} finally{\n    spinnerStop();\n}\n\n}\nfunction hasMorePhotos(totalPages) {\n    if(page < totalPages){\n        const item = document.querySelector('.gallery__item:last-child');\n    observer.observe(item);\n     } else{\n        iziToast.info({\n            position:'topRight',\n            message:\" We're sorry, but you've reached the end of the search result\",\n        });\n     }\n}\n\n\n// getPhotos('cat', 1).then(console.log);\n\n"],"names":["opts","target","formEl","listEl","page","query","options","callback","entries","observer","entry","loadMoreData","spinner","Spinner","onSubmit","event","spinnerPlay","spinnerStop","iziToast","results","total","total_pages","getPhotos","createMarkup","hasMorePhotos","arr","photo","axios","error","totalPages","item"],"mappings":"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"}